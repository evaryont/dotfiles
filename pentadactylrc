" Add the urlbar icons to the bottom status bar too
javascript <<EOF
(function(){
    var panel = document.createElement("statusbarpanel");
    panel.setAttribute("id", "urlbar-icons-clone");

    var urlbar = document.getElementById("urlbar-icons");

    var allicons = [];
    for(var i=0; i<urlbar.childNodes.length; ++i)
        allicons.push(urlbar.childNodes[i].id);

    for(var i=0; i<allicons.length; ++i) {
        var icon = document.getElementById(allicons[i]);

        if(icon.id == "go-button") continue;

        icon.setAttribute("style", "padding: 0; max-height: 16px;");
        panel.appendChild(icon);
    }

    var statbar = document.getElementById("status-bar");
    statbar.appendChild(panel);
})();
EOF

autocmd LocationChange reddit.com setlocal hinttags-=[onclick]

set showstatuslinks=status

" When loading a Lwn article, and it's subscriber-only, use Google's I'm Feeling
" Lucky search to try to find a shared version of the article (leaking it from
" behind the paywall)
autocmd -javascript PageLoad 'https://lwn.net/Articles/*' <<EOF
if (doc.title.match(/subscription/i)) {
    var title = doc.getElementsByClassName("ArticleText")[0].getElementsByTagName("a")[0].innerHTML;
    dactyl.open('https://encrypted.google.com/search?q=site:lwn.net/SubscriberLink "' + title + '"&btnI=');
}
EOF

"set passkeys+=^duckduckgo.com:hjklrstm1!vd<Return>
set passkeys+=^duckduckgo.com:hjkl<Return>

" Hide the 'give gold' link from comments
style -append reddit.com .give-gold { display: none !important; }

" Force the class list links to show
style -append intranet.known-universe.com #classListDiv { display: block !important; }
